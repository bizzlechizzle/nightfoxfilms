/**
 * Country Cultural Regions - National-level cultural regions (50 total)
 * Per DECISION-017: Local & Region sections overhaul
 *
 * Data source: country cultural regions/us_cultural_regions_v2.csv
 * Polygons: country cultural regions/us_cultural_regions_v2.geojson
 *
 * All data is embedded for offline-first compliance.
 */

// =============================================================================
// TYPES
// =============================================================================

export interface CountryCulturalRegion {
  id: number;
  name: string;
  category: string;
  description: string;
  latitude: number;
  longitude: number;
}

export interface CountryCulturalRegionWithDistance extends CountryCulturalRegion {
  distance: number;
}

// =============================================================================
// COUNTRY CULTURAL REGIONS DATA (from CSV)
// =============================================================================

export const COUNTRY_CULTURAL_REGIONS: CountryCulturalRegion[] = [
  { id: 1, name: 'Maritime New England', category: 'Northeast', description: 'Coastal Maine and New Hampshire', latitude: 44.9575, longitude: -69.0763 },
  { id: 2, name: 'Woodland New England', category: 'Northeast', description: 'Vermont; interior New Hampshire; western Massachusetts; Connecticut interior', latitude: 43.1929, longitude: -71.6405 },
  { id: 3, name: 'Upstate NY', category: 'Northeast', description: 'Northern and western New York State', latitude: 42.9814, longitude: -75.1860 },
  { id: 4, name: 'NYC Metro', category: 'Northeast', description: 'New York City; Long Island; northern New Jersey; southwestern Connecticut', latitude: 40.8974, longitude: -73.0615 },
  { id: 5, name: 'Mid-Atlantic', category: 'Northeast', description: 'Eastern Pennsylvania; Delaware; Maryland; DC suburbs', latitude: 39.9095, longitude: -76.1714 },
  { id: 6, name: 'Northern Appalachia', category: 'Northeast', description: 'Western Pennsylvania; West Virginia; eastern Ohio', latitude: 40.2730, longitude: -79.5730 },
  { id: 7, name: 'Northern Tidewaters', category: 'Northeast', description: 'Virginia coast; Chesapeake Bay; Eastern Shore of Maryland', latitude: 37.6750, longitude: -76.3594 },
  { id: 8, name: 'Upper Midwest', category: 'Midwest', description: 'Minnesota; eastern North and South Dakota', latitude: 46.4975, longitude: -93.5600 },
  { id: 9, name: 'Lower Midwest', category: 'Midwest', description: 'Iowa; Missouri; eastern Kansas and Nebraska', latitude: 40.6638, longitude: -93.3957 },
  { id: 10, name: 'Great Lakes', category: 'Midwest', description: 'Michigan; northern Indiana; northern Ohio', latitude: 43.7829, longitude: -85.0268 },
  { id: 11, name: 'Ohio River Valley', category: 'Midwest', description: 'Southern Ohio; Indiana; Kentucky', latitude: 38.5023, longitude: -84.0372 },
  { id: 12, name: 'Northwoods', category: 'Midwest', description: 'Northern Wisconsin; Upper Peninsula of Michigan; northern Minnesota', latitude: 46.3794, longitude: -87.8529 },
  { id: 13, name: 'Chicagoland', category: 'Midwest', description: 'Chicago metropolitan area', latitude: 41.9000, longitude: -87.5818 },
  { id: 14, name: 'Southern Tidewaters', category: 'The South', description: 'North Carolina; South Carolina; and Georgia coasts', latitude: 33.9512, longitude: -78.0791 },
  { id: 15, name: 'Piedmont', category: 'The South', description: 'Piedmont region of NC; SC; and Georgia', latitude: 34.6079, longitude: -79.9658 },
  { id: 16, name: 'Southern Appalachia', category: 'The South', description: 'Appalachian mountain region - eastern TN; western NC; eastern KY; SW Virginia', latitude: 36.8610, longitude: -82.4415 },
  { id: 17, name: 'Midsouth', category: 'The South', description: 'Middle Tennessee; northern Alabama', latitude: 35.5100, longitude: -86.5933 },
  { id: 18, name: 'The Ozarks', category: 'The South', description: 'Southern Missouri; northern Arkansas; eastern Oklahoma', latitude: 36.9556, longitude: -92.6111 },
  { id: 19, name: 'Deep South', category: 'The South', description: 'Central Alabama; Mississippi; Georgia', latitude: 32.9925, longitude: -86.4900 },
  { id: 20, name: 'Gulf Coast', category: 'The South', description: 'Florida panhandle; Alabama and Mississippi coasts', latitude: 30.6333, longitude: -86.2641 },
  { id: 21, name: 'Central Florida', category: 'The South', description: 'Central Florida peninsula', latitude: 28.5742, longitude: -81.5032 },
  { id: 22, name: 'Acadiana-Cajun', category: 'The South', description: 'Southern Louisiana; Cajun country', latitude: 30.4794, longitude: -91.5118 },
  { id: 23, name: 'Texas Heartland', category: 'The South', description: 'Central and East Texas', latitude: 30.9410, longitude: -95.9692 },
  { id: 24, name: 'Lower Rio Grande', category: 'The South', description: 'South Texas; Rio Grande Valley', latitude: 26.8719, longitude: -97.7094 },
  { id: 25, name: 'South Florida', category: 'Caribbean U.S.', description: 'South Florida; Miami metropolitan area', latitude: 25.8966, longitude: -81.1483 },
  { id: 26, name: 'Puerto Rico', category: 'Caribbean U.S.', description: 'Commonwealth of Puerto Rico', latitude: 18.2977, longitude: -66.5477 },
  { id: 27, name: 'US Virgin Islands', category: 'Caribbean U.S.', description: 'US Virgin Islands - St. Thomas; St. John; St. Croix', latitude: 18.3687, longitude: -64.9250 },
  { id: 28, name: 'Northern Great Plains', category: 'Frontier', description: 'Eastern Montana; North Dakota; northern South Dakota', latitude: 46.6417, longitude: -100.2139 },
  { id: 29, name: 'Black Hills', category: 'Frontier', description: 'Black Hills region of South Dakota and northeastern Wyoming', latitude: 44.0304, longitude: -103.4435 },
  { id: 30, name: 'Lower Great Plains', category: 'Frontier', description: 'Kansas; Nebraska; Oklahoma panhandle', latitude: 39.7468, longitude: -98.8809 },
  { id: 31, name: 'Columbia Plateau', category: 'Frontier', description: 'Eastern Washington; eastern Oregon; Idaho panhandle', latitude: 46.3516, longitude: -117.5355 },
  { id: 32, name: 'Northern Rockies', category: 'Frontier', description: 'Western Montana; northern Idaho; Wyoming', latitude: 46.3915, longitude: -109.5170 },
  { id: 33, name: 'Front Range', category: 'Frontier', description: 'Colorado Front Range; Denver metropolitan area', latitude: 39.0629, longitude: -104.6114 },
  { id: 34, name: 'Great Basin', category: 'Frontier', description: 'Nevada; western Utah', latitude: 38.7235, longitude: -115.5059 },
  { id: 35, name: 'Navajo Nation', category: 'Frontier', description: 'Four Corners region; Navajo and Hopi lands', latitude: 36.1000, longitude: -110.0400 },
  { id: 36, name: 'Mormon Corridor', category: 'Frontier', description: 'Utah; parts of Idaho; northern Arizona', latitude: 39.1341, longitude: -112.2488 },
  { id: 37, name: 'Classic Southwest', category: 'Frontier', description: 'Arizona; New Mexico', latitude: 34.3474, longitude: -111.3053 },
  { id: 38, name: 'Mezquital', category: 'Frontier', description: 'West Texas; southern New Mexico; Trans-Pecos region', latitude: 34.2636, longitude: -103.5515 },
  { id: 39, name: 'Cascadia', category: 'Pacific', description: 'Western Washington; western Oregon; Pacific Northwest coast', latitude: 46.7556, longitude: -122.3639 },
  { id: 40, name: 'Jefferson', category: 'Pacific', description: 'Southern Oregon; far northern California', latitude: 42.3886, longitude: -122.5200 },
  { id: 41, name: 'North Coast', category: 'Pacific', description: 'Northern California coast - Mendocino; Humboldt', latitude: 39.3381, longitude: -123.3476 },
  { id: 42, name: 'Central Valley', category: 'Pacific', description: 'California Central Valley - Sacramento to Bakersfield', latitude: 37.5780, longitude: -120.5951 },
  { id: 43, name: 'Sierra Nevadas', category: 'Pacific', description: 'Sierra Nevada mountain range', latitude: 37.8889, longitude: -118.7750 },
  { id: 44, name: 'SF Bay Area', category: 'Pacific', description: 'San Francisco Bay Area metropolitan region', latitude: 37.6500, longitude: -122.0864 },
  { id: 45, name: 'Central Coast', category: 'Pacific', description: 'California Central Coast - Monterey to Santa Barbara', latitude: 35.6000, longitude: -120.7400 },
  { id: 46, name: 'SoCal', category: 'Pacific', description: 'Southern California - Los Angeles; San Diego regions', latitude: 33.9541, longitude: -117.0459 },
  { id: 47, name: 'Hawaii', category: 'Alaska & Pacific Islands', description: 'Hawaiian Islands', latitude: 19.5636, longitude: -155.2182 },
  { id: 48, name: 'Alaskan First Nation', category: 'Alaska & Pacific Islands', description: 'Interior Alaska; native lands', latitude: 65.9909, longitude: -152.4659 },
  { id: 49, name: 'Alaskan Maritime', category: 'Alaska & Pacific Islands', description: 'Coastal Alaska; Aleutian Islands', latitude: 57.0571, longitude: -158.1143 },
  { id: 50, name: 'American Oceania', category: 'Alaska & Pacific Islands', description: 'Northern Mariana Islands; Guam; and American Samoa', latitude: 13.4500, longitude: 144.7750 },
];

// =============================================================================
// REGION CATEGORIES (for grouping in dropdowns)
// =============================================================================

export const COUNTRY_CULTURAL_REGION_CATEGORIES = [
  'Northeast',
  'Midwest',
  'The South',
  'Caribbean U.S.',
  'Frontier',
  'Pacific',
  'Alaska & Pacific Islands',
] as const;

export type CountryCulturalRegionCategory = typeof COUNTRY_CULTURAL_REGION_CATEGORIES[number];

// =============================================================================
// POLYGON DATA (from GeoJSON - coordinates are [lng, lat])
// =============================================================================

// Note: Full polygon data embedded for point-in-polygon checks
// Each polygon is an array of [longitude, latitude] coordinate pairs
// Source: country cultural regions/us_cultural_regions_v2.geojson
export const COUNTRY_CULTURAL_REGION_POLYGONS: Record<number, [number, number][]> = {
  // Maritime New England (id: 1)
  1: [[-66.95,44.8],[-67,44.9],[-67.2,45],[-67.5,45.2],[-67.8,45.5],[-68,45.8],[-68.2,46],[-68.4,46.4],[-68.5,46.8],[-68.6,47],[-68.8,47.2],[-69,47.4],[-69.2,47.3],[-69.5,47.2],[-70,46.8],[-70.3,46.4],[-70.5,46],[-70.7,45.6],[-70.8,45.3],[-70.9,45],[-71,44.8],[-71,44.5],[-70.9,44.2],[-70.8,44],[-70.7,43.8],[-70.6,43.6],[-70.5,43.4],[-70.3,43.2],[-70.1,43.1],[-69.8,43],[-69.5,43.1],[-69.2,43.2],[-68.8,43.4],[-68.4,43.6],[-68,43.8],[-67.5,44],[-67.2,44.2],[-67,44.4],[-66.95,44.6],[-66.95,44.8]],
  // Woodland New England (id: 2)
  2: [[-71,45],[-71.5,45],[-72,45],[-72.5,45],[-73,45],[-73.3,44.8],[-73.4,44.5],[-73.4,44.2],[-73.3,44],[-73.2,43.7],[-73.1,43.5],[-73,43.2],[-72.8,43],[-72.6,42.8],[-72.5,42.5],[-72.4,42.3],[-72.3,42.1],[-72.2,42],[-72,41.8],[-71.8,41.6],[-71.5,41.4],[-71.3,41.3],[-71.1,41.3],[-70.9,41.4],[-70.7,41.5],[-70.6,41.7],[-70.5,41.9],[-70.5,42.1],[-70.6,42.3],[-70.7,42.5],[-70.7,42.7],[-70.7,42.9],[-70.6,43.1],[-70.5,43.3],[-70.6,43.5],[-70.7,43.7],[-70.8,43.9],[-70.9,44.1],[-70.9,44.3],[-70.9,44.5],[-70.9,44.7],[-71,45]],
  // Upstate NY (id: 3)
  3: [[-73.3,45],[-73.5,45],[-74,45],[-74.5,45],[-75,44.8],[-75.5,44.5],[-76,44.2],[-76.5,44],[-77,43.8],[-77.5,43.5],[-78,43.3],[-78.5,43],[-79,43],[-79,42.8],[-78.8,42.5],[-78.5,42.2],[-78,42],[-77.5,42],[-77,42],[-76.5,42],[-76,42],[-75.5,42],[-75,42],[-74.8,41.8],[-74.6,41.6],[-74.4,41.4],[-74.2,41.3],[-74,41.2],[-73.8,41.2],[-73.6,41.3],[-73.5,41.5],[-73.4,41.8],[-73.4,42.1],[-73.4,42.4],[-73.4,42.7],[-73.3,43],[-73.3,43.3],[-73.3,43.6],[-73.3,43.9],[-73.3,44.2],[-73.3,44.5],[-73.3,44.8],[-73.3,45]],
  // NYC Metro (id: 4)
  4: [[-74.2,41.3],[-74,41.2],[-73.8,41.2],[-73.6,41.3],[-73.5,41.5],[-73.4,41.6],[-73.3,41.5],[-73.1,41.3],[-72.9,41.2],[-72.7,41.1],[-72.5,41],[-72.3,41],[-72,40.9],[-71.8,40.9],[-71.5,40.8],[-71.3,40.7],[-71,40.7],[-71,40.6],[-71.2,40.5],[-71.5,40.6],[-71.8,40.6],[-72,40.6],[-72.3,40.7],[-72.6,40.7],[-72.9,40.7],[-73.2,40.6],[-73.5,40.6],[-73.7,40.5],[-73.9,40.5],[-74,40.5],[-74.1,40.5],[-74.2,40.6],[-74.3,40.7],[-74.4,40.8],[-74.5,40.9],[-74.5,41],[-74.4,41.1],[-74.3,41.2],[-74.2,41.3]],
  // Mid-Atlantic (id: 5)
  5: [[-74.5,41],[-74.7,40.8],[-74.8,40.6],[-74.9,40.4],[-75,40.2],[-75.1,40],[-75.2,39.8],[-75.3,39.6],[-75.4,39.4],[-75.5,39.2],[-75.6,39],[-75.5,38.8],[-75.4,38.6],[-75.3,38.5],[-75.5,38.4],[-75.8,38.4],[-76,38.5],[-76.3,38.6],[-76.5,38.7],[-76.8,38.8],[-77,38.9],[-77.2,39],[-77.5,39.2],[-77.8,39.4],[-78,39.6],[-78.3,39.8],[-78.5,40],[-78.3,40.2],[-78,40.4],[-77.8,40.6],[-77.5,40.8],[-77.2,41],[-77,41],[-76.7,41],[-76.4,41],[-76.1,41],[-75.8,41],[-75.5,41],[-75.2,41],[-75,41],[-74.8,41],[-74.5,41]],
  // Northern Appalachia (id: 6)
  6: [[-78.5,42],[-79,42],[-79.5,42],[-79.8,42],[-80.2,41.8],[-80.5,41.5],[-80.8,41.2],[-81,41],[-81.2,40.7],[-81.4,40.4],[-81.5,40.2],[-81.5,40],[-81.4,39.8],[-81.2,39.5],[-81,39.3],[-80.8,39.1],[-80.5,39],[-80.2,38.9],[-80,38.8],[-79.8,38.7],[-79.5,38.6],[-79.3,38.7],[-79,38.8],[-78.8,39],[-78.5,39.2],[-78.3,39.4],[-78,39.6],[-78.3,39.8],[-78.5,40],[-78.5,40.3],[-78.5,40.6],[-78.3,40.8],[-78.2,41],[-78,41.2],[-78,41.5],[-78.2,41.7],[-78.5,42]],
  // Northern Tidewaters (id: 7)
  7: [[-75.3,38.5],[-75.4,38.4],[-75.5,38.3],[-75.6,38.1],[-75.7,37.9],[-75.8,37.7],[-75.9,37.5],[-76,37.3],[-76.1,37.1],[-76.2,36.9],[-76.3,36.7],[-76.4,36.6],[-76.6,36.6],[-76.8,36.6],[-77,36.6],[-77.2,36.7],[-77.4,36.8],[-77.5,37],[-77.6,37.2],[-77.5,37.4],[-77.4,37.6],[-77.2,37.8],[-77,38],[-76.8,38.2],[-76.6,38.4],[-76.4,38.5],[-76.2,38.6],[-76,38.6],[-75.8,38.5],[-75.6,38.5],[-75.4,38.5],[-75.3,38.5]],
  // Upper Midwest (id: 8) - Extended west to lng -97 at southern boundary
  8: [[-89.5,49],[-90,49],[-91,49],[-92,49],[-93,49],[-94,49],[-95,49],[-96,49],[-96.5,49],[-97,49],[-97,48.5],[-97,48],[-97,47.5],[-97.2,47],[-97.5,46.5],[-97.8,46],[-98,45.5],[-97.5,45],[-97,44.5],[-97,44],[-97,43.5],[-96.5,43.5],[-96,43.5],[-95.5,43.5],[-95,43.5],[-94.5,43.5],[-94,43.5],[-93.5,43.5],[-93,43.5],[-92.5,43.5],[-92,43.5],[-91.5,43.5],[-91,43.5],[-90.5,43.5],[-90.5,44],[-90.5,44.5],[-90.5,45],[-90,45.5],[-89.8,46],[-89.6,46.5],[-89.5,47],[-89.5,47.5],[-89.5,48],[-89.5,48.5],[-89.5,49]],
  // Lower Midwest (id: 9) - Eastern boundary extended to connect with Chicagoland at lat 39-43.5
  9: [[-91,43.5],[-91.5,43.5],[-92,43.5],[-92.5,43.5],[-93,43.5],[-93.5,43.5],[-94,43.5],[-94.5,43.5],[-95,43.5],[-95.5,43.5],[-96,43.5],[-96.5,43],[-97,42.5],[-97,42],[-97,41.5],[-97,41],[-97,40.5],[-97,40],[-97,39.5],[-97,39],[-96.5,38.5],[-96,38],[-95.5,37.5],[-95,37],[-94.6,36.8],[-94.2,37],[-94,37.3],[-93.5,37.5],[-93,37.8],[-92.5,38],[-92,38.3],[-91.5,38.5],[-91,38.8],[-90.8,39],[-90.5,39],[-90.5,39.5],[-90.5,40],[-90.5,40.5],[-90.5,41],[-90.5,41.5],[-90.5,42],[-90.5,42.5],[-90.5,43],[-91,43.5]],
  // Great Lakes (id: 10) - Extended south to lat 41, east to lng -81 with straight eastern boundary
  10: [[-81,45],[-81,44.5],[-81,44],[-81,43.5],[-81,43],[-81,42.5],[-81,42],[-81,41.5],[-81,41],[-81.5,41],[-82,41],[-82.5,41],[-83,41],[-83.5,41],[-84,41],[-84.5,41],[-85,41],[-85.5,41],[-86,41],[-86.3,41],[-86.5,41],[-86.8,41],[-87,41],[-87,41.5],[-87,42],[-87,42.5],[-87,43],[-87,43.5],[-86.8,43.8],[-86.5,44],[-86.3,44.3],[-86,44.5],[-85.8,44.8],[-85.5,45],[-85.3,45.3],[-85,45.5],[-84.8,45.8],[-84.5,46],[-84.2,46],[-84,45.8],[-83.5,45.5],[-83.2,45.3],[-82.8,45.2],[-82.4,45],[-82,45],[-81.5,45],[-81,45]],
  // Ohio River Valley (id: 11) - Extended northern boundary west to lat 41 to connect with Great Lakes
  11: [[-81,41],[-81.5,41],[-82,41],[-82.5,41],[-83,41],[-83.5,41],[-84,41],[-84.5,41],[-85,41],[-85.5,41],[-86,41],[-86.3,41],[-86.5,40.8],[-87,40.5],[-87.5,40],[-88,39.5],[-88,39],[-87.8,38.5],[-87.5,38],[-87,37.8],[-86.5,37.5],[-86,37.2],[-85.5,37],[-85,36.8],[-84.5,36.6],[-84,36.5],[-83.5,36.5],[-83,36.6],[-82.5,36.8],[-82,37],[-81.5,37.3],[-81,37.5],[-80.8,37.8],[-80.5,38],[-80.5,38.3],[-80.6,38.5],[-80.8,38.8],[-81,39.2],[-81,39.5],[-80.9,39.8],[-80.8,40],[-80.8,40.3],[-80.9,40.5],[-81,40.8],[-81,41]],
  // Northwoods (id: 12) - Extended to cover full Upper Peninsula with southern boundary at lat 45.5
  12: [[-80,47],[-80.5,47.2],[-81,47.5],[-81.5,47.8],[-82,48],[-82.5,48.2],[-83,48.5],[-83.5,48.8],[-84,49],[-84.5,49],[-85,49],[-85.5,49],[-86,49],[-86.5,49],[-87,49],[-87.5,49],[-88,49],[-88.5,49],[-89,49],[-89.5,49],[-89.5,48.5],[-89.5,48],[-89.5,47.5],[-89.5,47],[-89.6,46.5],[-89.8,46],[-90,45.5],[-90.3,45.3],[-90.5,45],[-90.5,44.5],[-90.5,44],[-90.5,43.5],[-90,43.5],[-89.5,43.5],[-89,43.5],[-88.5,43.5],[-88,43.5],[-87.5,43.5],[-87,43.5],[-87,44],[-87,44.5],[-87,45],[-86.5,45.3],[-86,45.5],[-85.5,45.5],[-85,45.5],[-84.5,45.8],[-84,46],[-83.5,46.2],[-83,46.5],[-82.5,46.5],[-82,46.5],[-81.5,46.5],[-81,46.5],[-80.5,46.7],[-80,47]],
  // Chicagoland (id: 13) - Extended to cover Illinois (lat 39-43.5, lng -87 to -90.5)
  13: [[-87,43.5],[-87.5,43.5],[-88,43.5],[-88.5,43.5],[-89,43.5],[-89.5,43.5],[-90,43.5],[-90.5,43.5],[-90.5,43],[-90.5,42.5],[-90.5,42],[-90.5,41.5],[-90.5,41],[-90.5,40.5],[-90.5,40],[-90.5,39.5],[-90.5,39],[-90,39],[-89.5,39],[-89,39],[-88.5,39],[-88,39],[-87.5,39],[-87,39],[-87,39.5],[-87,40],[-87,40.5],[-87,41],[-87,41.5],[-87,42],[-87,42.5],[-87,43],[-87,43.5]],
  // Southern Tidewaters (id: 14)
  14: [[-77,36.5],[-76.8,36.3],[-76.5,36],[-76.2,35.7],[-76,35.5],[-75.8,35.2],[-75.5,35],[-75.5,34.7],[-75.7,34.5],[-76,34.2],[-76.3,34],[-76.5,33.8],[-76.8,33.5],[-77.2,33.3],[-77.5,33],[-78,32.8],[-78.5,32.5],[-79,32.3],[-79.5,32],[-80,31.8],[-80.5,31.5],[-81,31.3],[-81.2,31.5],[-81,31.8],[-80.8,32],[-80.5,32.3],[-80.2,32.5],[-80,32.8],[-79.8,33],[-79.5,33.3],[-79.2,33.5],[-79,33.8],[-78.8,34],[-78.5,34.3],[-78.2,34.5],[-78,34.8],[-77.8,35],[-77.5,35.3],[-77.3,35.5],[-77.2,35.8],[-77.1,36],[-77,36.3],[-77,36.5]],
  // Piedmont (id: 15)
  15: [[-77.5,36.5],[-78,36.5],[-78.5,36.5],[-79,36.5],[-79.5,36.3],[-80,36],[-80.3,35.8],[-80.5,35.5],[-80.8,35.2],[-81,35],[-81.2,34.8],[-81.5,34.5],[-81.8,34.2],[-82,34],[-82.2,33.8],[-82.5,33.5],[-82.3,33.2],[-82,33],[-81.8,32.8],[-81.5,32.5],[-81.2,32.3],[-81,32.5],[-80.8,32.8],[-80.5,33],[-80.2,33.3],[-80,33.5],[-79.8,33.8],[-79.5,34],[-79.2,34.3],[-79,34.5],[-78.8,34.8],[-78.5,35],[-78.2,35.2],[-78,35.5],[-77.8,35.8],[-77.5,36],[-77.3,36.2],[-77.5,36.5]],
  // Southern Appalachia (id: 16)
  16: [[-79.5,38.6],[-79.8,38.4],[-80,38.2],[-80.2,38],[-80.5,37.8],[-80.8,37.5],[-81,37.3],[-81.2,37],[-81.5,36.8],[-81.8,36.5],[-82,36.3],[-82.2,36],[-82.5,35.8],[-82.8,35.5],[-83,35.3],[-83.3,35],[-83.5,34.8],[-83.8,34.5],[-84,34.5],[-84.3,34.8],[-84.5,35],[-84.8,35.3],[-85,35.5],[-85,35.8],[-84.8,36],[-84.5,36.3],[-84.3,36.5],[-84,36.8],[-83.8,37],[-83.5,37.3],[-83.2,37.5],[-83,37.8],[-82.8,38],[-82.5,38.2],[-82.2,38.5],[-82,38.5],[-81.5,38.5],[-81,38.5],[-80.5,38.5],[-80,38.6],[-79.5,38.6]],
  // Midsouth (id: 17)
  17: [[-85,36.5],[-85.5,36.5],[-86,36.5],[-86.5,36.5],[-87,36.5],[-87.5,36.5],[-88,36.5],[-88.5,36.3],[-89,36],[-89,35.8],[-88.8,35.5],[-88.5,35.2],[-88.2,35],[-88,34.8],[-87.8,34.5],[-87.5,34.5],[-87.2,34.5],[-87,34.5],[-86.5,34.5],[-86,34.5],[-85.5,34.5],[-85,34.5],[-84.8,34.8],[-85,35],[-85,35.3],[-85,35.5],[-85,35.8],[-85,36],[-85,36.3],[-85,36.5]],
  // The Ozarks (id: 18)
  18: [[-91,38.5],[-91.5,38.3],[-92,38],[-92.5,37.8],[-93,37.5],[-93.5,37.3],[-94,37],[-94.5,36.8],[-94.6,36.5],[-94.5,36.2],[-94.3,36],[-94,35.8],[-93.8,35.5],[-93.5,35.3],[-93.2,35.5],[-93,35.8],[-92.8,36],[-92.5,36.3],[-92.2,36.5],[-92,36.8],[-91.8,37],[-91.5,37.3],[-91.2,37.5],[-91,37.8],[-90.8,38],[-90.8,38.3],[-91,38.5]],
  // Deep South (id: 19)
  19: [[-82.5,33.5],[-83,33.2],[-83.5,33],[-84,32.8],[-84.5,32.5],[-85,32.2],[-85.5,32],[-86,31.8],[-86.5,31.5],[-87,31.3],[-87.5,31],[-88,31],[-88.5,31],[-89,31],[-89.5,31.2],[-89.8,31.5],[-90,31.8],[-90,32],[-89.8,32.3],[-89.5,32.5],[-89.2,32.8],[-89,33],[-88.8,33.3],[-88.5,33.5],[-88.2,33.8],[-88,34],[-87.8,34.2],[-87.5,34.5],[-87,34.5],[-86.5,34.5],[-86,34.5],[-85.5,34.5],[-85,34.5],[-84.5,34.5],[-84,34.5],[-83.5,34.5],[-83.2,34.2],[-83,34],[-82.8,33.8],[-82.5,33.5]],
  // Gulf Coast (id: 20)
  20: [[-87.5,31],[-87,31],[-86.5,31],[-86,31],[-85.5,31],[-85,30.8],[-84.5,30.5],[-84,30.2],[-83.5,30],[-83,29.8],[-82.5,29.8],[-82.5,30],[-82.8,30.2],[-83,30.5],[-83.3,30.8],[-83.5,31],[-84,31],[-84.5,31],[-85,31],[-85.5,31],[-86,31],[-86.5,31],[-87,31],[-87.3,30.8],[-87.5,30.5],[-87.8,30.3],[-88,30.2],[-88.3,30.3],[-88.5,30.5],[-88.8,30.5],[-89,30.3],[-89.2,30.2],[-89.5,30.2],[-89.5,30.5],[-89.3,30.8],[-89,31],[-88.5,31],[-88,31],[-87.5,31]],
  // Central Florida (id: 21)
  21: [[-81,30],[-81.2,29.8],[-81.5,29.5],[-81.5,29.2],[-81.3,29],[-81,28.8],[-80.8,28.5],[-80.5,28.2],[-80.3,28],[-80.2,27.8],[-80.3,27.5],[-80.5,27.3],[-80.8,27.2],[-81,27],[-81.3,27],[-81.5,27.2],[-81.8,27.3],[-82,27.5],[-82.3,27.8],[-82.5,28],[-82.7,28.3],[-82.8,28.5],[-82.8,28.8],[-82.7,29],[-82.5,29.3],[-82.3,29.5],[-82,29.8],[-81.8,30],[-81.5,30],[-81.2,30],[-81,30]],
  // Acadiana-Cajun (id: 22)
  22: [[-89.5,31],[-89.8,30.8],[-90,30.5],[-90.2,30.2],[-90.5,30],[-90.8,29.8],[-91,29.5],[-91.3,29.3],[-91.5,29.2],[-91.8,29.2],[-92,29.3],[-92.3,29.5],[-92.5,29.7],[-92.8,29.8],[-93,30],[-93.3,30.2],[-93.5,30.5],[-93.5,30.8],[-93.3,31],[-93,31.2],[-92.8,31.3],[-92.5,31.3],[-92.2,31.2],[-92,31],[-91.8,30.8],[-91.5,30.8],[-91.2,31],[-91,31.2],[-90.8,31.2],[-90.5,31],[-90.2,30.8],[-90,31],[-89.8,31.2],[-89.5,31]],
  // Texas Heartland (id: 23)
  23: [[-93.5,33.5],[-94,33.5],[-94.5,33.2],[-95,33],[-95.5,32.8],[-96,32.5],[-96.5,32.2],[-97,32],[-97.5,31.8],[-98,31.5],[-98.5,31.2],[-99,31],[-99,30.5],[-98.8,30.2],[-98.5,30],[-98.2,29.8],[-98,29.5],[-97.8,29.2],[-97.5,29],[-97.2,28.8],[-97,28.5],[-96.8,28.5],[-96.5,28.8],[-96.2,29],[-96,29.3],[-95.8,29.5],[-95.5,29.8],[-95.2,30],[-95,30.2],[-94.8,30.5],[-94.5,30.8],[-94.2,31],[-94,31.3],[-93.8,31.5],[-93.5,31.8],[-93.5,32],[-93.5,32.5],[-93.5,33],[-93.5,33.5]],
  // Lower Rio Grande (id: 24)
  24: [[-97,28.5],[-97.2,28.3],[-97.5,28],[-97.8,27.8],[-98,27.5],[-98.2,27.2],[-98.5,27],[-98.8,26.8],[-99,26.5],[-99.2,26.2],[-99.5,26],[-99.5,25.8],[-99.2,25.9],[-99,26],[-98.8,26.1],[-98.5,26.1],[-98.2,26],[-98,26],[-97.8,26],[-97.5,26],[-97.2,26.1],[-97,26.2],[-96.8,26.3],[-96.5,26.5],[-96.3,26.8],[-96.2,27],[-96.2,27.3],[-96.3,27.5],[-96.5,27.8],[-96.7,28],[-96.8,28.2],[-97,28.5]],
  // South Florida (id: 25)
  25: [[-80.3,27],[-80.2,26.8],[-80.1,26.5],[-80,26.2],[-80.1,26],[-80.2,25.8],[-80.3,25.5],[-80.4,25.2],[-80.5,25],[-80.7,24.8],[-81,24.6],[-81.3,24.5],[-81.6,24.5],[-81.8,24.6],[-82,24.8],[-82.2,25],[-82.3,25.3],[-82.4,25.5],[-82.4,25.8],[-82.3,26],[-82.2,26.3],[-82,26.5],[-81.8,26.8],[-81.5,27],[-81.2,27],[-81,27],[-80.7,27],[-80.5,27],[-80.3,27]],
  // Puerto Rico (id: 26)
  26: [[-65.6,18.4],[-65.8,18.35],[-66,18.3],[-66.2,18.25],[-66.4,18.2],[-66.6,18.15],[-66.8,18.1],[-67,18.05],[-67.15,18],[-67.25,18],[-67.3,18.1],[-67.25,18.2],[-67.2,18.3],[-67.1,18.4],[-67,18.48],[-66.8,18.5],[-66.6,18.5],[-66.4,18.5],[-66.2,18.48],[-66,18.46],[-65.8,18.43],[-65.6,18.4]],
  // US Virgin Islands (id: 27)
  27: [[-64.85,18.38],[-64.9,18.35],[-64.95,18.33],[-65,18.35],[-65,18.38],[-64.95,18.4],[-64.9,18.38],[-64.85,18.38]],
  // Northern Great Plains (id: 28)
  28: [[-97,49],[-98,49],[-99,49],[-100,49],[-101,49],[-102,49],[-103,49],[-104,49],[-104,48.5],[-104,48],[-104,47.5],[-104,47],[-104,46.5],[-104,46],[-103.5,45.8],[-103,45.5],[-102.5,45.2],[-102,45],[-101.5,44.8],[-101,44.5],[-100.5,44.3],[-100,44],[-99.5,44],[-99,44],[-98.5,44.2],[-98,44.5],[-97.5,44.8],[-97.2,45],[-97,45.5],[-97,46],[-97,46.5],[-97,47],[-97,47.5],[-97,48],[-97,48.5],[-97,49]],
  // Black Hills (id: 29)
  29: [[-102,45],[-102.5,45],[-103,45],[-103.5,44.8],[-104,44.5],[-104.5,44.2],[-105,44],[-105.3,43.8],[-105.5,43.5],[-105.5,43.2],[-105.3,43],[-105,42.8],[-104.5,42.8],[-104,43],[-103.5,43.2],[-103,43.5],[-102.5,43.8],[-102,44],[-101.8,44.3],[-101.5,44.5],[-101.5,44.8],[-101.8,45],[-102,45]],
  // Lower Great Plains (id: 30) - Extended north to lat 43.5, east to lng -96.8 for coverage
  30: [[-96.8,43.5],[-97.5,43.5],[-98,43.5],[-98.5,43.5],[-99,43.5],[-99.5,43.5],[-100,43.5],[-100.5,43.2],[-101,42.8],[-101.5,42.5],[-102,42],[-102,41.5],[-102,41],[-102,40.5],[-102,40],[-102,39.5],[-102,39],[-102,38.5],[-102,38],[-102,37.5],[-102,37],[-101.5,37],[-101,37],[-100.5,36.8],[-100,36.5],[-99.5,36.5],[-99,36.5],[-98.5,36.5],[-98,36.8],[-97.5,37],[-97,37.3],[-96.5,37.5],[-96,37.8],[-95.5,38],[-95.2,38.3],[-95,38.5],[-95.2,38.8],[-95.5,39],[-96,39.3],[-96.5,39.5],[-96.8,40],[-96.8,40.5],[-96.8,41],[-96.8,41.5],[-96.8,42],[-96.8,42.5],[-96.8,43],[-96.8,43.5]],
  // Columbia Plateau (id: 31)
  31: [[-117,49],[-117.5,49],[-118,49],[-118.5,48.8],[-119,48.5],[-119.5,48.2],[-120,48],[-120.5,47.5],[-121,47],[-121,46.5],[-120.5,46],[-120,45.5],[-119.5,45],[-119,44.5],[-118.5,44],[-118,43.8],[-117.5,43.5],[-117,43.5],[-116.5,43.8],[-116,44],[-115.5,44.3],[-115,44.5],[-114.8,45],[-114.5,45.5],[-114.5,46],[-114.8,46.5],[-115,47],[-115.5,47.5],[-116,48],[-116.5,48.5],[-117,49]],
  // Northern Rockies (id: 32)
  32: [[-104,49],[-105,49],[-106,49],[-107,49],[-108,49],[-109,49],[-110,49],[-111,49],[-112,49],[-113,49],[-114,49],[-114.5,48.8],[-115,48.5],[-115.5,48],[-116,47.5],[-115.5,47],[-115,46.5],[-114.8,46],[-114.5,45.5],[-114.5,45],[-114,44.5],[-113.5,44],[-113,43.8],[-112.5,43.5],[-112,43.2],[-111.5,43],[-111,42.8],[-110.5,43],[-110,43.5],[-109.5,44],[-109,44.5],[-108.5,44.8],[-108,45],[-107.5,45],[-107,45],[-106.5,45],[-106,45],[-105.5,45.2],[-105,45.5],[-104.5,45.8],[-104,46],[-104,46.5],[-104,47],[-104,47.5],[-104,48],[-104,48.5],[-104,49]],
  // Front Range (id: 33)
  33: [[-104,41],[-104.5,41],[-105,40.8],[-105.5,40.5],[-106,40.2],[-106.3,40],[-106.5,39.8],[-106.8,39.5],[-107,39.2],[-107,39],[-106.8,38.8],[-106.5,38.5],[-106.2,38.2],[-106,38],[-105.8,37.8],[-105.5,37.5],[-105.2,37.2],[-105,37],[-104.8,37],[-104.5,37.2],[-104.2,37.5],[-104,37.8],[-103.8,38],[-103.5,38.3],[-103.2,38.5],[-103,38.8],[-102.8,39],[-102.5,39.3],[-102.3,39.5],[-102.2,39.8],[-102,40],[-102.5,40.2],[-103,40.5],[-103.5,40.8],[-104,41]],
  // Great Basin (id: 34)
  34: [[-114,42],[-114.5,41.8],[-115,41.5],[-115.5,41.2],[-116,41],[-116.5,40.8],[-117,40.5],[-117.5,40],[-118,39.5],[-118.5,39],[-119,38.5],[-119,38],[-118.5,37.5],[-118,37],[-117.5,36.5],[-117,36],[-116.5,35.8],[-116,35.5],[-115.5,35.5],[-115,35.8],[-114.5,36],[-114,36.2],[-114,36.5],[-114,37],[-113.5,37.5],[-113,38],[-113,38.5],[-113.2,39],[-113.5,39.5],[-114,40],[-114,40.5],[-114,41],[-114,41.5],[-114,42]],
  // Navajo Nation (id: 35)
  35: [[-109,37],[-109.5,37],[-110,37],[-110.5,36.8],[-111,36.5],[-111.5,36.2],[-111.5,36],[-111.2,35.8],[-111,35.5],[-110.8,35.2],[-110.5,35],[-110.2,35],[-110,35.2],[-109.8,35.5],[-109.5,35.8],[-109.2,36],[-109,36.2],[-108.8,36.5],[-108.8,36.8],[-109,37]],
  // Mormon Corridor (id: 36)
  36: [[-111,42],[-111.5,42],[-112,42],[-112.5,42],[-113,42],[-113.5,41.8],[-114,41.5],[-114,41],[-114,40.5],[-114,40],[-113.5,39.5],[-113.2,39],[-113,38.5],[-113,38],[-113.2,37.5],[-113.5,37],[-114,36.5],[-114,36.2],[-113.5,36],[-113,36],[-112.5,36.2],[-112,36.5],[-111.5,36.8],[-111.2,37],[-111,37.2],[-110.8,37.5],[-111,37.8],[-111.2,38],[-111.5,38.3],[-111.8,38.5],[-112,38.8],[-112,39],[-111.8,39.3],[-111.5,39.5],[-111.2,39.8],[-111,40],[-110.8,40.3],[-111,40.5],[-111,41],[-111,41.5],[-111,42]],
  // Classic Southwest (id: 37)
  37: [[-109,37],[-108.8,36.5],[-109,36],[-109,35.5],[-109,35],[-109,34.5],[-109,34],[-109,33.5],[-109,33],[-109,32.5],[-109.2,32],[-109.5,31.5],[-110,31.3],[-110.5,31.3],[-111,31.3],[-111.5,31.5],[-112,31.8],[-112.5,32],[-113,32.2],[-113.5,32.5],[-114,32.7],[-114.5,33],[-114.8,33.5],[-114.8,34],[-114.5,34.5],[-114.2,35],[-114,35.5],[-113.8,36],[-113.5,36],[-113,36],[-112.5,36.2],[-112,36.5],[-111.5,36.8],[-111,36.8],[-110.5,36.8],[-110,37],[-109.5,37],[-109,37]],
  // Mezquital (id: 38)
  38: [[-100,36.5],[-100.5,36],[-101,35.5],[-101.5,35],[-102,34.5],[-102.5,34],[-103,33.5],[-103.5,33],[-104,32.5],[-104.5,32],[-105,31.5],[-105.5,31],[-106,31],[-106.5,31],[-106.5,31.5],[-106.2,32],[-106,32.5],[-105.8,33],[-105.5,33.5],[-105.2,34],[-105,34.5],[-104.8,35],[-104.5,35.2],[-104.2,35.5],[-104,35.8],[-103.5,36],[-103,36.2],[-102.5,36.5],[-102,36.5],[-101.5,36.5],[-101,36.5],[-100.5,36.5],[-100,36.5]],
  // Cascadia (id: 39)
  39: [[-122,49],[-122.5,49],[-123,48.8],[-123.5,48.5],[-124,48.2],[-124.5,47.8],[-124.7,47.5],[-124.8,47],[-124.5,46.5],[-124.2,46],[-123.8,45.5],[-123.5,45],[-123.2,44.5],[-123,44],[-122.8,44],[-122.5,44.2],[-122.2,44.5],[-122,44.8],[-121.8,45],[-121.5,45.3],[-121.2,45.5],[-121,45.8],[-120.8,46],[-120.5,46.3],[-120.5,46.5],[-120.8,46.8],[-121,47],[-121.2,47.3],[-121.5,47.5],[-121.8,47.8],[-122,48],[-122,48.3],[-121.8,48.5],[-121.5,48.8],[-121.5,49],[-122,49]],
  // Jefferson (id: 40)
  40: [[-123,44],[-123.2,43.8],[-123.5,43.5],[-123.8,43.2],[-124,43],[-124.3,42.8],[-124.5,42.5],[-124.5,42],[-124.3,41.8],[-124,41.5],[-123.8,41.2],[-123.5,41],[-123.2,40.8],[-123,40.5],[-122.8,40.5],[-122.5,40.8],[-122.2,41],[-122,41.3],[-121.8,41.5],[-121.5,41.8],[-121.2,42],[-121,42],[-120.8,42],[-120.5,42],[-120.5,42.3],[-120.8,42.5],[-121,42.8],[-121.2,43],[-121.5,43.2],[-121.8,43.5],[-122,43.8],[-122.2,44],[-122.5,44],[-122.8,44],[-123,44]],
  // North Coast (id: 41)
  41: [[-123,40.5],[-123.2,40.3],[-123.5,40],[-123.8,39.8],[-124,39.5],[-124.2,39.2],[-124.3,39],[-124.2,38.8],[-124,38.5],[-123.8,38.3],[-123.5,38.2],[-123.2,38.3],[-123,38.5],[-122.8,38.8],[-122.8,39],[-122.8,39.3],[-122.8,39.5],[-122.8,39.8],[-122.8,40],[-122.8,40.3],[-123,40.5]],
  // Central Valley (id: 42)
  42: [[-121.5,40],[-121.8,39.8],[-122,39.5],[-122.2,39.2],[-122.3,39],[-122.3,38.8],[-122.2,38.5],[-122,38.2],[-121.8,38],[-121.5,37.8],[-121.2,37.5],[-121,37.2],[-120.8,37],[-120.5,36.8],[-120.2,36.5],[-120,36.2],[-119.8,36],[-119.5,35.8],[-119.2,35.5],[-119,35.3],[-118.8,35.2],[-118.5,35.2],[-118.5,35.5],[-118.8,35.8],[-119,36],[-119.2,36.3],[-119.5,36.5],[-119.8,36.8],[-120,37],[-120.2,37.3],[-120.5,37.5],[-120.8,37.8],[-121,38],[-121,38.3],[-121,38.5],[-121,38.8],[-121,39],[-121,39.3],[-121.2,39.5],[-121.3,39.8],[-121.5,40]],
  // Sierra Nevadas (id: 43)
  43: [[-119,40],[-119.5,39.8],[-120,39.5],[-120.2,39.2],[-120.3,39],[-120.3,38.8],[-120.2,38.5],[-120,38.2],[-119.8,38],[-119.5,37.8],[-119.2,37.5],[-119,37.2],[-118.8,37],[-118.5,36.8],[-118.2,36.5],[-118,36.2],[-117.8,36],[-117.5,35.8],[-117.3,35.8],[-117.5,36],[-117.8,36.3],[-118,36.5],[-118.2,36.8],[-118.5,37],[-118.7,37.3],[-118.8,37.5],[-118.8,37.8],[-118.7,38],[-118.5,38.3],[-118.3,38.5],[-118.2,38.8],[-118.2,39],[-118.3,39.3],[-118.5,39.5],[-118.8,39.8],[-119,40]],
  // SF Bay Area (id: 44)
  44: [[-122,38.2],[-122.2,38.2],[-122.4,38.1],[-122.6,38],[-122.8,37.9],[-123,37.8],[-123,37.6],[-122.8,37.4],[-122.6,37.2],[-122.4,37],[-122.2,37],[-122,37],[-121.8,37.1],[-121.6,37.2],[-121.4,37.3],[-121.3,37.4],[-121.3,37.6],[-121.4,37.8],[-121.5,38],[-121.7,38.1],[-121.9,38.2],[-122,38.2]],
  // Central Coast (id: 45)
  45: [[-121,37],[-121.2,36.8],[-121.5,36.5],[-121.8,36.2],[-122,36],[-122,35.8],[-121.8,35.5],[-121.5,35.2],[-121.2,35],[-121,34.8],[-120.8,34.5],[-120.5,34.4],[-120.2,34.4],[-120,34.5],[-119.8,34.6],[-119.5,34.7],[-119.5,35],[-119.8,35.2],[-120,35.5],[-120.2,35.8],[-120.5,36],[-120.5,36.3],[-120.5,36.5],[-120.7,36.8],[-121,37]],
  // SoCal (id: 46)
  46: [[-117,35.5],[-117.3,35.3],[-117.5,35],[-117.8,34.8],[-118,34.5],[-118.3,34.2],[-118.5,34],[-118.8,33.8],[-119,33.5],[-119.2,33.2],[-119.5,33],[-119.5,32.8],[-119.2,32.8],[-119,32.9],[-118.5,33],[-118,33.2],[-117.5,33],[-117.2,32.8],[-117,32.5],[-116.8,32.5],[-116.5,32.6],[-116.2,32.8],[-116,33],[-115.8,33.2],[-115.5,33.5],[-115.2,33.8],[-115,34],[-114.8,34.3],[-114.8,34.5],[-115,34.8],[-115.2,35],[-115.5,35.2],[-115.8,35.3],[-116,35.5],[-116.3,35.5],[-116.5,35.5],[-117,35.5]],
  // Hawaii (id: 47)
  47: [[-155,19],[-155.2,19.2],[-155.5,19.5],[-155.8,19.8],[-155.8,20],[-155.5,20.2],[-155,20],[-154.8,19.8],[-154.8,19.5],[-155,19.2],[-155,19]],
  // Alaskan First Nation (id: 48)
  48: [[-141,70],[-141,69],[-141,68],[-141,67],[-141,66],[-141,65],[-141,64],[-141.5,63.5],[-142,63],[-143,62.5],[-144,62],[-145,61.5],[-146,61],[-147,60.5],[-148,60],[-150,60.5],[-152,61],[-154,61.5],[-156,62],[-158,62.5],[-160,63],[-162,63.5],[-164,64],[-165,64.5],[-166,65],[-167,65.5],[-168,66],[-168,66.5],[-167,67],[-166,67.5],[-165,68],[-164,68.5],[-162,69],[-160,69.5],[-158,70],[-156,70.5],[-154,71],[-152,71.3],[-150,71.3],[-148,71],[-146,70.5],[-144,70],[-142,70],[-141,70]],
  // Alaskan Maritime (id: 49)
  49: [[-148,60],[-149,59.5],[-150,59],[-151,58.5],[-152,58],[-153,57.5],[-154,57],[-155,56.5],[-156,56],[-157,55.5],[-158,55.5],[-159,55.5],[-160,55.5],[-161,55.5],[-162,55.5],[-163,55],[-164,54.8],[-165,54.5],[-166,54.2],[-166.5,54],[-166.5,54.5],[-166,55],[-165,55.5],[-164,56],[-163,56.5],[-162,57],[-161,57.5],[-160,58],[-159,58.5],[-158,59],[-156,60],[-154,60.5],[-152,61],[-150,60.5],[-148,60]],
  // American Oceania (id: 50)
  50: [[144.6,13.3],[144.7,13.4],[144.9,13.5],[145,13.5],[144.95,13.6],[144.8,13.55],[144.65,13.45],[144.6,13.3]],
};

// =============================================================================
// UTILITY FUNCTIONS
// =============================================================================

/**
 * Convert degrees to radians
 */
function toRad(deg: number): number {
  return deg * (Math.PI / 180);
}

/**
 * Calculate Haversine distance between two GPS coordinates
 * @returns Distance in miles
 */
export function haversineDistance(lat1: number, lng1: number, lat2: number, lng2: number): number {
  const R = 3959; // Earth's radius in miles
  const dLat = toRad(lat2 - lat1);
  const dLng = toRad(lng2 - lng1);
  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
            Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
            Math.sin(dLng / 2) * Math.sin(dLng / 2);
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
}

/**
 * Check if a point is inside a polygon using ray-casting algorithm
 * @param lat Latitude of point
 * @param lng Longitude of point
 * @param polygon Array of [longitude, latitude] coordinate pairs
 */
export function pointInPolygon(lat: number, lng: number, polygon: [number, number][]): boolean {
  let inside = false;
  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
    // Polygon coordinates are [lng, lat] - use lng for X axis, lat for Y axis
    const xi = polygon[i][0], yi = polygon[i][1]; // lng, lat
    const xj = polygon[j][0], yj = polygon[j][1]; // lng, lat
    if (((yi > lat) !== (yj > lat)) && (lng < (xj - xi) * (lat - yi) / (yj - yi) + xi)) {
      inside = !inside;
    }
  }
  return inside;
}

/**
 * Get Country Cultural Region from GPS coordinates using point-in-polygon
 * Falls back to nearest region if point-in-polygon fails
 * Always returns a region name (never null) for valid US coordinates
 * @returns Region name or null only if coordinates are invalid
 */
export function getCountryCulturalRegion(lat: number, lng: number): string | null {
  // Validate coordinates
  if (lat == null || lng == null || isNaN(lat) || isNaN(lng)) {
    return null;
  }

  // Try point-in-polygon first (most accurate)
  for (const region of COUNTRY_CULTURAL_REGIONS) {
    const polygon = COUNTRY_CULTURAL_REGION_POLYGONS[region.id];
    if (polygon && pointInPolygon(lat, lng, polygon)) {
      return region.name;
    }
  }

  // Fallback: find the absolute nearest region by center distance
  // This ensures we always return a region for valid GPS coordinates
  const nearest = COUNTRY_CULTURAL_REGIONS
    .map(region => ({
      name: region.name,
      distance: haversineDistance(lat, lng, region.latitude, region.longitude),
    }))
    .sort((a, b) => a.distance - b.distance)[0];

  return nearest ? nearest.name : null;
}

/**
 * Get Country Cultural Regions nearby (within specified miles) and sorted by distance
 * @param lat Latitude
 * @param lng Longitude
 * @param maxMiles Maximum distance in miles (default 50)
 * @returns Array of regions with distance, sorted by distance
 */
export function getNearbyCountryCulturalRegions(
  lat: number,
  lng: number,
  maxMiles: number = 50
): CountryCulturalRegionWithDistance[] {
  return COUNTRY_CULTURAL_REGIONS
    .map(region => ({
      ...region,
      distance: haversineDistance(lat, lng, region.latitude, region.longitude),
    }))
    .filter(r => {
      // Include if within max distance OR point is inside the polygon
      if (r.distance <= maxMiles) return true;
      const polygon = COUNTRY_CULTURAL_REGION_POLYGONS[r.id];
      return polygon && pointInPolygon(lat, lng, polygon);
    })
    .sort((a, b) => a.distance - b.distance);
}

/**
 * Get all Country Cultural Regions grouped by category
 * Used when GPS is not available
 */
export function getCountryCulturalRegionsByCategory(): Record<string, CountryCulturalRegion[]> {
  const grouped: Record<string, CountryCulturalRegion[]> = {};
  for (const category of COUNTRY_CULTURAL_REGION_CATEGORIES) {
    grouped[category] = COUNTRY_CULTURAL_REGIONS.filter(r => r.category === category);
  }
  return grouped;
}

/**
 * Validate that a country cultural region name is valid
 */
export function isValidCountryCulturalRegion(name: string | null | undefined): boolean {
  if (!name) return true; // null is valid (not set)
  return COUNTRY_CULTURAL_REGIONS.some(r => r.name === name);
}
